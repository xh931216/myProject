<?xml version="1.0" encoding="UTF-8" ?>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>员工询价页</title>
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="This is my page">
<link href="../assets/css/default.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="../Easyui/themes/default/easyui.css" />
<link rel="stylesheet" type="text/css" href="../Easyui/themes/icon.css" />
<script type="text/javascript" src="../Easyui/jquery.min.js"></script>
<script type="text/javascript" src="../Easyui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="../Easyui/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="../assets/js/image.js"></script>

</head>
<body >
	 <!-- 创建一个更改对话框 -->
	 
   <div id="mainPanle" region="center" style="background: #eee; overflow-y:hidden">
	 <div style="width: 100%;height:100%;background-color: #FFFFFF"  >
	 <div id="departDlg" title="添加信息"
		closed="true" style="width:500px">
		<div style="padding:10px 60px 20px 60px">
			<form id="staffForm" method="POST" action="addStaffDesired.action" class="easyui-form" enctype="multipart/form-data">
				<table cellpadding="7">			
					 <tr>
						<td style="width:70px">物资类别:</td>
							<td><input id="srname" class="easyui-combobox" style="width:250px" required="required" name="srid"
						data-options="valueField:'srid',textField:'srname',url:'getRankAllNameList.action'" />
						</td>
					</tr>
					<tr>
						<td >开始时间:</td>
							<td><input type="text" id="startDate" style="width:250px" name="startDate" class="easyui-datetimebox" required="required"/>
						</td>
					</tr>
					<tr>
						<td >结束时间:</td>
							<td><input type="text" id="overDate" style="width:250px" name="overDate" class="easyui-datetimebox" required="required"/>
						</td>
					</tr>
					<tr>
						<td >询价单:</td>
							<td>
							  <input class="easyui-filebox" style="width:250px" data-options='prompt:"选择询价单照片",buttonText:"选择",onChange:change_photo' 
							  id="file_upload" name="file_upload" required="required"/>
							  <a href="javascript:void(0)" class="easyui-linkbutton"
								onclick="imageShow();">浏览询价单</a>
						</td>
						
					</tr>
					<tr>
						<td >发布:</td>
        				<td style="text-align:left">
           					<span class="radioSpan">
               					 <input type="radio" name="state" value="0">否</input>
               					 <input type="radio" name="state" value="1" checked="checked">是</input>
           					</span>
						</td>
					</tr>
				</table>
				
			</form>
			<div style="text-align:center;padding:3px">
				<a href="javascript:void(0)" class="easyui-linkbutton" icon="icon-ok"
					onclick="saveDesired();">添加</a>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="javascript:void(0)"  icon="icon-cancel"
					class="easyui-linkbutton" onclick="clearForm();">清空</a>
			</div>
			</div>
	</div>	
	</div>
	</div>
	<!-- 图片预览功能 -->
	<div style="display: none">
    	<div id="dlg" class="datagrid-toolbar" style="padding:5px;">
      	  <img id="Img" src="" onload="DrawImage(this)"/>
    	</div>
	</div>
	<script type="text/javascript">
	var url = null;
	function imageShow(){
		if(url == null){
			$.messager.alert('提示', '先选择文件', 'info');
			return;
		}
		 $('#dlg').dialog({
	            title: '预览',
	            width: 700,
	            height: 400,
	            resizable: true,
	            closed: false,
	            cache: false,
	            modal: true
	     });
	};
	
	function change_photo(){
		url = $(this).filebox('getValue');
        PreviewImage($("input[name='file']")[0], 'Img', 'dlg'); 
    };
	
    // 保存信息
	function saveDesired() {
		$("#staffForm").form("submit", {
			onSubmit : function() {
				return $(this).form('enableValidation').form('validate');
			},
			success : function(data) {	
				var data = eval('(' + data + ')');
                if(data.success=="true"){  
					$("#adminListDg").datagrid("reload");
	            }
				$.messager.show({
					title : "提示信息",
					msg : data.message
				});
			}
		});
	}
	
	
	function clearForm() {
		$('#staffForm').form('clear');
	}
    
	</script>
</body>
</html>
